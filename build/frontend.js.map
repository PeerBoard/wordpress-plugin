{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./node_modules/@peerboard/core/dist/peerboard-core.cjs.js","webpack:///./src/js/frontend.js","webpack:///./src/js/functions.js","webpack:///./src/js/inc/create-forum.js"],"names":["create_forum","createForum","serializeArray","form","arr","Array","prototype","slice","call","elements","forEach","field","name","disabled","indexOf","type","options","option","selected","push","value","checked","setWaitingForReady","timeout","Promise","resolve","reject","_peerboardSettings","setTimeout","docReady","fn","document","readyState","addEventListener","fix_page_meta","target","getElementById","querySelector","setAttribute","location","origin","pathname","remove","_","title","window","history","replaceState","innerHeight","cookie","console","error","alert","body","innerHTML","className"],"mappings":";QAAA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;;QAEA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;;;QAGA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA,0CAA0C,gCAAgC;QAC1E;QACA;;QAEA;QACA;QACA;QACA,wDAAwD,kBAAkB;QAC1E;QACA,iDAAiD,cAAc;QAC/D;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA,yCAAyC,iCAAiC;QAC1E,gHAAgH,mBAAmB,EAAE;QACrI;QACA;;QAEA;QACA;QACA;QACA,2BAA2B,0BAA0B,EAAE;QACvD,iCAAiC,eAAe;QAChD;QACA;QACA;;QAEA;QACA,sDAAsD,+DAA+D;;QAErH;QACA;;;QAGA;QACA;;;;;;;;;;;;;AClFa;;AAEb,8CAA8C,cAAc;;AAE5D;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,gDAAgD,OAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,sCAAsC,EAAE;AAC9E,uCAAuC,sCAAsC,kCAAkC;AAC/G;AACA;AACA,mCAAmC,oBAAoB,uCAAuC;AAC9F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mFAAmF,UAAU;AAC7F;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,iBAAiB,EAAE;AACnB,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;;;;;;;;;;;;;ACzGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;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","file":"frontend.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/js/frontend.js\");\n","'use strict';\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n\r\nvar __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\n\nvar PEERBOARD_EMBED_SDK_URL = 'https://static.peerboard.com/embed/embed.js';\r\nvar trimLeftSlash = function (str) {\r\n    return str.startsWith('/') ? str.substr(1) : str;\r\n};\r\nvar forumSDK = null;\r\nvar loadingSDK = null;\r\nvar loadSdk = function (embedSDKURL) {\r\n    if (forumSDK !== null) {\r\n        return Promise.resolve();\r\n    }\r\n    if (loadingSDK !== null) {\r\n        return loadingSDK;\r\n    }\r\n    return loadingSDK = new Promise(function (resolve, reject) {\r\n        var script = document.createElement('script');\r\n        script.src = embedSDKURL || PEERBOARD_EMBED_SDK_URL;\r\n        script.setAttribute(\"async\", \"\");\r\n        script.setAttribute(\"data-skip-init\", \"\");\r\n        script.onload = function () {\r\n            forumSDK = window.PeerboardSDK;\r\n            resolve();\r\n        };\r\n        script.onerror = function () {\r\n            console.error('failed to download sdk');\r\n            reject();\r\n            loadingSDK = null;\r\n        };\r\n        document.head.append(script);\r\n    });\r\n};\r\nvar defaultOptions = {\r\n    resize: true,\r\n    hideMenu: true,\r\n    baseURL: \"https://peerboard.\" + window.document.location.hostname,\r\n    sdkURL: PEERBOARD_EMBED_SDK_URL,\r\n    onTitleChanged: function (title) { return window.document.title = title; },\r\n    onPathChanged: function (newPath) { return window.history.replaceState({}, window.document.title, newPath); }\r\n};\r\nvar createForum = function (forumID, container, options) {\r\n    var opts = __assign(__assign({}, defaultOptions), { scrollToTopOnNavigationChanged: true });\r\n    if (!opts.usePathFromQs) {\r\n        // Auto resolve redirect\r\n        opts.path = ((options.prefix && options.prefix !== \"/\")\r\n            ? document.location.pathname.replace(new RegExp(\"^/\" + trimLeftSlash(options.prefix)), '')\r\n            : document.location.pathname) + document.location.search + document.location.hash;\r\n    }\r\n    Object.assign(opts, options);\r\n    return loadSdk(options.sdkURL).then(function () {\r\n        if (!forumSDK) {\r\n            throw new Error(\"Forum should be loaded at the moment.\");\r\n        }\r\n        return new Promise(function (resolve, reject) {\r\n            var api = forumSDK.createForum(forumID, container, __assign(__assign({}, opts), { onFail: function () {\r\n                    if (opts.onFail) {\r\n                        opts.onFail();\r\n                    }\r\n                    reject(new Error(\"failed to initialize PeerBoard iframe internals\"));\r\n                }, onReady: function () {\r\n                    if (opts.onReady) {\r\n                        opts.onReady();\r\n                    }\r\n                    resolve(api);\r\n                } }));\r\n        });\r\n    }).catch(function (err) {\r\n        console.error(\"Error creating forum: \", err);\r\n        if (options.onFail) {\r\n            options.onFail();\r\n        }\r\n        throw err;\r\n    });\r\n};\n\nexports.loadSdk = loadSdk;\nexports.createForum = createForum;\n//# sourceMappingURL=peerboard-core.cjs.js.map\n","/**\n * Gutenberg Blocks\n *\n * All blocks related JavaScript files should be imported here.\n * You can create a new block folder in this dir and include code\n * for that block here as well.\n *\n * All blocks should be included here since this is the file that\n * Webpack is compiling as the input file.\n */\n\nimport './functions.js';\n\nimport { createForum } from \"@peerboard/core\";\n\n\n/**\n * Create forum\n */\nimport create_forum from './inc/create-forum';\ncreate_forum(createForum)\n\n","/**\n * Vanilla js serialize array function\n * @param {*} form \n */\nvar serializeArray = function (form) {\n    var arr = [];\n    Array.prototype.slice.call(form.elements).forEach(function (field) {\n        if (!field.name || field.disabled || ['file', 'reset', 'submit', 'button'].indexOf(field.type) > -1) return;\n        if (field.type === 'select-multiple') {\n            Array.prototype.slice.call(field.options).forEach(function (option) {\n                if (!option.selected) return;\n                arr.push({\n                    name: field.name,\n                    value: option.value\n                });\n            });\n            return;\n        }\n        if (['checkbox', 'radio'].indexOf(field.type) >-1 && !field.checked) return;\n        arr.push({\n            name: field.name,\n            value: field.value\n        });\n    });\n    return arr;\n};","export default (createForum) => {\n\n  const setWaitingForReady = (timeout) => new Promise((resolve, reject) => {\n    _peerboardSettings['onReady'] = () => {\n      resolve();\n    }\n    setTimeout(() => {\n      reject();\n    }, timeout)\n  });\n\n  function docReady(fn) {\n    // see if DOM is already available\n    if (document.readyState === \"complete\" || document.readyState === \"interactive\") {\n      // call on next available tick\n      setTimeout(fn, 1);\n    } else {\n      document.addEventListener(\"DOMContentLoaded\", fn);\n    }\n  }\n\n  /**\n   * Temporary solution for changing page meta\n   */\n  function fix_page_meta() {\n\n    let target = document.getElementById('peerboard-forum');\n\n    if (target === null) {return}\n\n    document.querySelector(\"link[rel=canonical]\").setAttribute(\"href\", document.location.origin + document.location.pathname);\n\n    try { document.querySelector(\"meta[name=description]\").remove(); } catch (_) { };\n  }\n\n  _peerboardSettings['onTitleChanged'] = (title) => {\n    window.document.title = title\n  };\n\n  _peerboardSettings['onPathChanged'] = location => history.replaceState(null, '', location);\n  _peerboardSettings['minHeight'] = window.innerHeight + \"px\";\n  _peerboardSettings['onLogout'] = () => {\n    document.cookie = 'wp-peerboard-auth=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/;';\n  }\n  _peerboardSettings['onFail'] = () => {\n    console.error('Failed to load forum - please contact us at support_wp@peerboard.com')\n    alert(\"Something really unexpected happened - please contact us at support_wp@peerboard.com\")\n  }\n\n  docReady(function () {\n    let target = document.getElementById('peerboard-forum');\n    if (target === null) {\n      // Means that we have no the_content tag\n      // Just embed inside the body\n      target = document.body;\n      document.body.innerHTML = '';\n    } else {\n      if (target.className === 'disabled') {\n        return;\n      }\n    }\n\n    createForum(_peerboardSettings['board-id'], target, _peerboardSettings);\n  });\n}\n"],"sourceRoot":""}