{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/js/admin.js","webpack:///./src/js/admin/feedback-form.js"],"names":["feedback_form","modal_init","deactivate_button","document","getElementById","modal","close","modal_deactivation_button","deactivation_url","href","reasons","onclick","ev","preventDefault","formData","FormData","append","fetch","window","peerboard_admin","ajax_url","method","body","then","response","json","data","success","querySelector","stringToHTML","querySelectorAll","classList","add","remove","reasons_logic","disabled","send_feedback","console","log","catch","forEach","elem","key","main_reason_wrap","main_reason","value","additional_info","location","custom_on_load","callback","addEventListener","attachEvent","onload","str","dom","createElement","innerHTML"],"mappings":"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","file":"admin.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/js/admin.js\");\n","\r\n/**\r\n * Feedback form\r\n */\r\n import feedback_form from './admin/feedback-form';\r\n\r\n feedback_form()","export default () => {\r\n    function modal_init() {\r\n        let deactivate_button = document.getElementById('deactivate-peerboard');\r\n\r\n        if(!deactivate_button){\r\n            return;\r\n        }\r\n\r\n        let modal,\r\n            close,\r\n            modal_deactivation_button,\r\n            deactivation_url = deactivate_button.href,\r\n            reasons;\r\n\r\n        /**\r\n         * Open modal\r\n         * @param {*} ev \r\n         */\r\n        deactivate_button.onclick = (ev) => {\r\n            ev.preventDefault()\r\n\r\n            let formData = new FormData();\r\n\r\n            formData.append('action', 'peerboard_add_deactivation_feedback_dialog_box');\r\n\r\n            fetch(window.peerboard_admin.ajax_url, {\r\n                method: 'POST',\r\n                body: formData\r\n            })\r\n                .then(response => response.json())\r\n                .then(data => {\r\n                    if (data.success) {\r\n                        let response = data.data\r\n\r\n                        document.querySelector('body').append(stringToHTML(response))\r\n\r\n                        modal = document.getElementById('peerboard-modal-deactivation-feedback')\r\n                        close = modal.querySelector('.button-close')\r\n                        modal_deactivation_button = modal.querySelector('.button-deactivate')\r\n                        reasons = modal.querySelectorAll('.reason')\r\n\r\n                        modal.classList.add('active')\r\n                        modal_deactivation_button.href = deactivation_url\r\n\r\n                        // Close modal\r\n                        close.onclick = (ev) => {\r\n                            ev.preventDefault()\r\n                            modal.classList.remove('active')\r\n                        }\r\n\r\n                        reasons_logic()\r\n\r\n                        modal_deactivation_button.onclick = (ev) => {\r\n                            ev.preventDefault()\r\n                            modal_deactivation_button.disabled = true\r\n                            send_feedback()\r\n                        }\r\n                    } else {\r\n                        console.log(data);\r\n                    }\r\n                }).catch()\r\n        }\r\n\r\n        function reasons_logic() {\r\n            /**\r\n            * If reasons list have additional field show\r\n            */\r\n            reasons.forEach((elem, key) => {\r\n                elem.onclick = (ev) => {\r\n                    // disable all actives \r\n                    modal.querySelectorAll('.reason.active').forEach((elem) => {\r\n                        elem.classList.remove('active')\r\n                    })\r\n\r\n                    elem.classList.add('active')\r\n                }\r\n            })\r\n        }\r\n\r\n        /**\r\n         * Send feedback\r\n         */\r\n        function send_feedback() {\r\n            let formData = new FormData(),\r\n                main_reason_wrap = modal.querySelector('.reason.active');\r\n            if (main_reason_wrap) {\r\n                let main_reason = main_reason_wrap.querySelector('input.main_reason').value,\r\n                    additional_info = main_reason_wrap.querySelector('.additional_field input').value\r\n                formData.append('main_reason', main_reason);\r\n                formData.append('additional_info', additional_info);\r\n            }\r\n\r\n            formData.append('action', 'peerboard_feedback_request');\r\n\r\n            fetch(window.peerboard_admin.ajax_url, {\r\n                method: 'POST',\r\n                body: formData\r\n            })\r\n                .then(response => response.json())\r\n                .then(data => {\r\n                    if (data.success) {\r\n                        let response = data.data\r\n\r\n                        window.location.href = deactivation_url\r\n                    } else {\r\n                        console.log(data);\r\n                    }\r\n                }).catch()\r\n        }\r\n    }\r\n\r\n    /**\r\n    * Load after full page ready + some seconds \r\n    */\r\n    custom_on_load(modal_init);\r\n\r\n    /**\r\n    * On load custom function\r\n    * @param {*} callback \r\n    */\r\n    function custom_on_load(callback) {\r\n        if (window.addEventListener)\r\n            window.addEventListener(\"load\", callback, false);\r\n        else if (window.attachEvent)\r\n            window.attachEvent(\"onload\", callback);\r\n        else window.onload = callback;\r\n    }\r\n\r\n\r\n    /**\r\n    * Convert a template string into HTML DOM nodes\r\n    * @param  {String} str The template string\r\n    * @return {Node}       The template HTML\r\n    */\r\n    function stringToHTML(str) {\r\n        var dom = document.createElement('div');\r\n        dom.innerHTML = str;\r\n        return dom;\r\n    };\r\n}"],"sourceRoot":""}